!function(n,i,e){var o="JSSocials",s=function(e,t){return i.isFunction(e)?e.apply(t,i.makeArray(arguments).slice(2)):e},r=/(\.(jpeg|png|gif|bmp|svg)$|^data:image\/(jpeg|png|gif|bmp|svg\+xml);base64)/i,t=/(&?[a-zA-Z0-9]+=)?\{([a-zA-Z0-9]+)\}/g,a={G:1e9,M:1e6,K:1e3},l={};function h(e,t){var s=i(e);s.data(o,this),this._$element=s,this.shares=[],this._init(t),this._render()}h.prototype={url:"",text:"",shareIn:"blank",showLabel:function(e){return!1===this.showCount?e>this.smallScreenWidth:e>=this.largeScreenWidth},showCount:function(e){return!(e<=this.smallScreenWidth)||"inside"},smallScreenWidth:640,largeScreenWidth:1024,resizeTimeout:200,elementClass:"jssocials",sharesClass:"jssocials-shares",shareClass:"jssocials-share",shareButtonClass:"jssocials-share-button",shareLinkClass:"jssocials-share-link",shareLogoClass:"jssocials-share-logo",shareLabelClass:"jssocials-share-label",shareLinkCountClass:"jssocials-share-link-count",shareCountBoxClass:"jssocials-share-count-box",shareCountClass:"jssocials-share-count",shareZeroCountClass:"jssocials-share-no-count",_init:function(e){this._initDefaults(),i.extend(this,e),this._initShares(),this._attachWindowResizeCallback()},_initDefaults:function(){this.url=n.location.href,this.text=i.trim(i("meta[name=description]").attr("content")||i("title").text())},_initShares:function(){this.shares=i.map(this.shares,i.proxy(function(e){"string"==typeof e&&(e={share:e});var t=e.share&&l[e.share];if(!t&&!e.renderer)throw Error("Share '"+e.share+"' is not found");return i.extend({url:this.url,text:this.text},t,e)},this))},_attachWindowResizeCallback:function(){i(n).on("resize",i.proxy(this._windowResizeHandler,this))},_detachWindowResizeCallback:function(){i(n).off("resize",this._windowResizeHandler)},_windowResizeHandler:function(){(i.isFunction(this.showLabel)||i.isFunction(this.showCount))&&(n.clearTimeout(this._resizeTimer),this._resizeTimer=setTimeout(i.proxy(this.refresh,this),this.resizeTimeout))},_render:function(){this._clear(),this._defineOptionsByScreen(),this._$element.addClass(this.elementClass),this._$shares=i("<div>").addClass(this.sharesClass).appendTo(this._$element),this._renderShares()},_defineOptionsByScreen:function(){this._screenWidth=i(n).width(),this._showLabel=s(this.showLabel,this,this._screenWidth),this._showCount=s(this.showCount,this,this._screenWidth)},_renderShares:function(){i.each(this.shares,i.proxy(function(e,t){this._renderShare(t)},this))},_renderShare:function(e){(i.isFunction(e.renderer)?i(e.renderer()):this._createShare(e)).addClass(this.shareClass).addClass(e.share?"jssocials-share-"+e.share:"").addClass(e.css).appendTo(this._$shares)},_createShare:function(e){var t=i("<div>"),s=this._createShareLink(e).appendTo(t);if(this._showCount){var r="inside"===this._showCount,a=r?s:i("<div>").addClass(this.shareCountBoxClass).appendTo(t);a.addClass(r?this.shareLinkCountClass:this.shareCountBoxClass),this._renderShareCount(e,a)}return t},_createShareLink:function(s){var r=this._getShareStrategy(s).call(s,{shareUrl:this._getShareUrl(s)});return r.addClass(this.shareLinkClass).append(this._createShareLogo(s)),this._showLabel&&r.append(this._createShareLabel(s)),i.each(this.on||{},function(e,t){i.isFunction(t)&&r.on(e,i.proxy(t,s))}),r},_getShareStrategy:function(e){var t=u[e.shareIn||this.shareIn];if(!t)throw Error("Share strategy '"+this.shareIn+"' not found");return t},_getShareUrl:function(e){var t=s(e.shareUrl,e);return this._formatShareUrl(t,e)},_createShareLogo:function(e){var t=e.logo,s=r.test(t)?i("<img>").attr("src",e.logo):i("<i>").addClass(t);return s.addClass(this.shareLogoClass),s},_createShareLabel:function(e){return i("<span>").addClass(this.shareLabelClass).text(e.label)},_renderShareCount:function(e,t){var s=i("<span>").addClass(this.shareCountClass);t.addClass(this.shareZeroCountClass).append(s),this._loadCount(e).done(i.proxy(function(e){e&&(t.removeClass(this.shareZeroCountClass),s.text(e))},this))},_loadCount:function(t){var s=i.Deferred(),e=this._getCountUrl(t);if(!e)return s.resolve(0).promise();var r=i.proxy(function(e){s.resolve(this._getCountValue(e,t))},this);return i.getJSON(e).done(r).fail(function(){i.get(e).done(r).fail(function(){s.resolve(0)})}),s.promise()},_getCountUrl:function(e){var t=s(e.countUrl,e);return this._formatShareUrl(t,e)},_getCountValue:function(e,t){var s=(i.isFunction(t.getCount)?t.getCount(e):e)||0;return"string"==typeof s?s:this._formatNumber(s)},_formatNumber:function(s){return i.each(a,function(e,t){if(t<=s)return s=parseFloat((s/t).toFixed(2))+e,!1}),s},_formatShareUrl:function(e,a){return e.replace(t,function(e,t,s){var r=a[s]||"";return r?(t||"")+n.encodeURIComponent(r):""})},_clear:function(){n.clearTimeout(this._resizeTimer),this._$element.empty()},_passOptionToShares:function(s,r){var a=this.shares;i.each(["url","text"],function(e,t){t===s&&i.each(a,function(e,t){t[s]=r})})},_normalizeShare:function(t){return i.isNumeric(t)?this.shares[t]:"string"==typeof t?i.grep(this.shares,function(e){return e.share===t})[0]:t},refresh:function(){this._render()},destroy:function(){this._clear(),this._detachWindowResizeCallback(),this._$element.removeClass(this.elementClass).removeData(o)},option:function(e,t){if(1===arguments.length)return this[e];this[e]=t,this._passOptionToShares(e,t),this.refresh()},shareOption:function(e,t,s){if(e=this._normalizeShare(e),2===arguments.length)return e[t];e[t]=s,this.refresh()}},i.fn.jsSocials=function(r){var a=i.makeArray(arguments).slice(1),n=this;return this.each(function(){var e,t=i(this),s=t.data(o);if(s)if("string"==typeof r){if(void 0!==(e=s[r].apply(s,a))&&e!==s)return n=e,!1}else s._detachWindowResizeCallback(),s._init(r),s._render();else new h(t,r)}),n};var u={popup:function(e){return i("<a>").attr("href","#").on("click",function(){return n.open(e.shareUrl,null,"width=600, height=400, location=0, menubar=0, resizeable=0, scrollbars=0, status=0, titlebar=0, toolbar=0"),!1})},blank:function(e){return i("<a>").attr({target:"_blank",href:e.shareUrl})},self:function(e){return i("<a>").attr({target:"_self",href:e.shareUrl})}};n.jsSocials={Socials:h,shares:l,shareStrategies:u,setDefaults:function(e){var t;i.isPlainObject(e)?t=h.prototype:(t=l[e],e=arguments[1]||{}),i.extend(t,e)}}}(window,jQuery),function(e,t,s,r){t.extend(s.shares,{email:{label:"E-mail",logo:"fa fa-at",shareUrl:"mailto:{to}?subject={text}&body={url}",countUrl:"",shareIn:"self"},twitter:{label:"Tweet",logo:"fa fa-twitter",shareUrl:"https://twitter.com/share?url={url}&text={text}&via={via}&hashtags={hashtags}",countUrl:""},facebook:{label:"Like",logo:"fa fa-facebook",shareUrl:"https://facebook.com/sharer/sharer.php?u={url}",countUrl:"https://graph.facebook.com/?id={url}",getCount:function(e){return e.share&&e.share.share_count||0}},vkontakte:{label:"Like",logo:"fa fa-vk",shareUrl:"https://vk.com/share.php?url={url}&title={title}&description={text}",countUrl:"https://vk.com/share.php?act=count&index=1&url={url}",getCount:function(e){return parseInt(e.slice(15,-2).split(", ")[1])}},googleplus:{label:"+1",logo:"fa fa-google",shareUrl:"https://plus.google.com/share?url={url}",countUrl:""},linkedin:{label:"Share",logo:"fa fa-linkedin",shareUrl:"https://www.linkedin.com/shareArticle?mini=true&url={url}",countUrl:"https://www.linkedin.com/countserv/count/share?format=jsonp&url={url}&callback=?",getCount:function(e){return e.count}},pinterest:{label:"Pin it",logo:"fa fa-pinterest",shareUrl:"https://pinterest.com/pin/create/bookmarklet/?media={media}&url={url}&description={text}",countUrl:"https://api.pinterest.com/v1/urls/count.json?&url={url}&callback=?",getCount:function(e){return e.count}},stumbleupon:{label:"Share",logo:"fa fa-stumbleupon",shareUrl:"http://www.stumbleupon.com/submit?url={url}&title={title}",countUrl:"https://cors-anywhere.herokuapp.com/https://www.stumbleupon.com/services/1.01/badge.getinfo?url={url}",getCount:function(e){return e.result&&e.result.views}},telegram:{label:"Telegram",logo:"fa fa-telegram",shareUrl:"tg://msg?text={url} {text}",countUrl:"",shareIn:"self"},whatsapp:{label:"WhatsApp",logo:"fa fa-whatsapp",shareUrl:"whatsapp://send?text={url} {text}",countUrl:"",shareIn:"self"},line:{label:"LINE",logo:"fa fa-comment",shareUrl:"http://line.me/R/msg/text/?{text} {url}",countUrl:""},viber:{label:"Viber",logo:"fa fa-volume-control-phone",shareUrl:"viber://forward?text={url} {text}",countUrl:"",shareIn:"self"},pocket:{label:"Pocket",logo:"fa fa-get-pocket",shareUrl:"https://getpocket.com/save?url={url}&title={title}",countUrl:""},messenger:{label:"Share",logo:"fa fa-commenting",shareUrl:"fb-messenger://share?link={url}",countUrl:"",shareIn:"self"},rss:{label:"RSS",logo:"fa fa-rss",shareUrl:"/feeds/",countUrl:"",shareIn:"blank"}})}(window,jQuery,window.jsSocials);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpzc29jaWFscy5qcyJdLCJuYW1lcyI6WyJ3aW5kb3ciLCIkIiwidW5kZWZpbmVkIiwiSlNTT0NJQUxTX0RBVEFfS0VZIiwiZ2V0T3JBcHBseSIsInZhbHVlIiwiY29udGV4dCIsImlzRnVuY3Rpb24iLCJhcHBseSIsIm1ha2VBcnJheSIsImFyZ3VtZW50cyIsInNsaWNlIiwiSU1HX1NSQ19SRUdFWCIsIlVSTF9QQVJBTVNfUkVHRVgiLCJNRUFTVVJFUyIsIkciLCJNIiwiSyIsInNoYXJlcyIsIlNvY2lhbHMiLCJlbGVtZW50IiwiY29uZmlnIiwiJGVsZW1lbnQiLCJkYXRhIiwidGhpcyIsIl8kZWxlbWVudCIsIl9pbml0IiwiX3JlbmRlciIsInByb3RvdHlwZSIsInVybCIsInRleHQiLCJzaGFyZUluIiwic2hvd0xhYmVsIiwic2NyZWVuV2lkdGgiLCJzaG93Q291bnQiLCJzbWFsbFNjcmVlbldpZHRoIiwibGFyZ2VTY3JlZW5XaWR0aCIsInJlc2l6ZVRpbWVvdXQiLCJlbGVtZW50Q2xhc3MiLCJzaGFyZXNDbGFzcyIsInNoYXJlQ2xhc3MiLCJzaGFyZUJ1dHRvbkNsYXNzIiwic2hhcmVMaW5rQ2xhc3MiLCJzaGFyZUxvZ29DbGFzcyIsInNoYXJlTGFiZWxDbGFzcyIsInNoYXJlTGlua0NvdW50Q2xhc3MiLCJzaGFyZUNvdW50Qm94Q2xhc3MiLCJzaGFyZUNvdW50Q2xhc3MiLCJzaGFyZVplcm9Db3VudENsYXNzIiwiX2luaXREZWZhdWx0cyIsImV4dGVuZCIsIl9pbml0U2hhcmVzIiwiX2F0dGFjaFdpbmRvd1Jlc2l6ZUNhbGxiYWNrIiwibG9jYXRpb24iLCJocmVmIiwidHJpbSIsImF0dHIiLCJtYXAiLCJwcm94eSIsInNoYXJlQ29uZmlnIiwic2hhcmUiLCJyZW5kZXJlciIsIkVycm9yIiwib24iLCJfd2luZG93UmVzaXplSGFuZGxlciIsIl9kZXRhY2hXaW5kb3dSZXNpemVDYWxsYmFjayIsIm9mZiIsImNsZWFyVGltZW91dCIsIl9yZXNpemVUaW1lciIsInNldFRpbWVvdXQiLCJyZWZyZXNoIiwiX2NsZWFyIiwiX2RlZmluZU9wdGlvbnNCeVNjcmVlbiIsImFkZENsYXNzIiwiXyRzaGFyZXMiLCJhcHBlbmRUbyIsIl9yZW5kZXJTaGFyZXMiLCJfc2NyZWVuV2lkdGgiLCJ3aWR0aCIsIl9zaG93TGFiZWwiLCJfc2hvd0NvdW50IiwiZWFjaCIsIl8iLCJfcmVuZGVyU2hhcmUiLCJfY3JlYXRlU2hhcmUiLCJjc3MiLCIkcmVzdWx0IiwiJHNoYXJlTGluayIsIl9jcmVhdGVTaGFyZUxpbmsiLCJpc0luc2lkZUNvdW50IiwiJGNvdW50Q29udGFpbmVyIiwiX3JlbmRlclNoYXJlQ291bnQiLCJfZ2V0U2hhcmVTdHJhdGVneSIsImNhbGwiLCJzaGFyZVVybCIsIl9nZXRTaGFyZVVybCIsImFwcGVuZCIsIl9jcmVhdGVTaGFyZUxvZ28iLCJfY3JlYXRlU2hhcmVMYWJlbCIsImV2ZW50IiwiaGFuZGxlciIsInJlc3VsdCIsInNoYXJlU3RyYXRlZ2llcyIsIl9mb3JtYXRTaGFyZVVybCIsImxvZ28iLCJ0ZXN0IiwibGFiZWwiLCIkY29udGFpbmVyIiwiJGNvdW50IiwiX2xvYWRDb3VudCIsImRvbmUiLCJjb3VudCIsInJlbW92ZUNsYXNzIiwiZGVmZXJyZWQiLCJEZWZlcnJlZCIsImNvdW50VXJsIiwiX2dldENvdW50VXJsIiwicmVzb2x2ZSIsInByb21pc2UiLCJoYW5kbGVTdWNjZXNzIiwicmVzcG9uc2UiLCJfZ2V0Q291bnRWYWx1ZSIsImdldEpTT04iLCJmYWlsIiwiZ2V0IiwiZ2V0Q291bnQiLCJfZm9ybWF0TnVtYmVyIiwibnVtYmVyIiwibGV0dGVyIiwicGFyc2VGbG9hdCIsInRvRml4ZWQiLCJyZXBsYWNlIiwibWF0Y2giLCJrZXkiLCJmaWVsZCIsImVuY29kZVVSSUNvbXBvbmVudCIsImVtcHR5IiwiX3Bhc3NPcHRpb25Ub1NoYXJlcyIsIm9wdGlvbk5hbWUiLCJfbm9ybWFsaXplU2hhcmUiLCJpc051bWVyaWMiLCJncmVwIiwicyIsImRlc3Ryb3kiLCJyZW1vdmVEYXRhIiwib3B0aW9uIiwibGVuZ3RoIiwic2hhcmVPcHRpb24iLCJmbiIsImpzU29jaWFscyIsIm1ldGhvZEFyZ3MiLCJtZXRob2RSZXN1bHQiLCJpbnN0YW5jZSIsInBvcHVwIiwiYXJncyIsIm9wZW4iLCJibGFuayIsInRhcmdldCIsInNlbGYiLCJzZXREZWZhdWx0cyIsImNvbXBvbmVudCIsImlzUGxhaW5PYmplY3QiLCJqUXVlcnkiLCJlbWFpbCIsInR3aXR0ZXIiLCJmYWNlYm9vayIsInNoYXJlX2NvdW50IiwidmtvbnRha3RlIiwicGFyc2VJbnQiLCJzcGxpdCIsImdvb2dsZXBsdXMiLCJsaW5rZWRpbiIsInBpbnRlcmVzdCIsInN0dW1ibGV1cG9uIiwidmlld3MiLCJ0ZWxlZ3JhbSIsIndoYXRzYXBwIiwibGluZSIsInZpYmVyIiwicG9ja2V0IiwibWVzc2VuZ2VyIiwicnNzIl0sIm1hcHBpbmdzIjoiQ0FHQyxTQUFTQSxFQUFRQyxFQUFHQyxHQUVqQixJQUNJQyxFQURZLFlBR1pDLEVBQWEsU0FBU0MsRUFBT0MsR0FDN0IsT0FBR0wsRUFBRU0sV0FBV0YsR0FDTEEsRUFBTUcsTUFBTUYsRUFBU0wsRUFBRVEsVUFBVUMsV0FBV0MsTUFBTSxJQUV0RE4sR0FHUE8sRUFBZ0IsK0VBQ2hCQyxFQUFtQix3Q0FFbkJDLEVBQVcsQ0FDWEMsRUFBSyxJQUNMQyxFQUFLLElBQ0xDLEVBQUssS0FHTEMsRUFBUyxHQUViLFNBQVNDLEVBQVFDLEVBQVNDLEdBQ3RCLElBQUlDLEVBQVdyQixFQUFFbUIsR0FFakJFLEVBQVNDLEtBQUtwQixFQUFvQnFCLE1BRWxDQSxLQUFLQyxVQUFZSCxFQUVqQkUsS0FBS04sT0FBUyxHQUVkTSxLQUFLRSxNQUFNTCxHQUNYRyxLQUFLRyxVQUdUUixFQUFRUyxVQUFZLENBQ2hCQyxJQUFLLEdBQ0xDLEtBQU0sR0FDTkMsUUFBUyxRQUVUQyxVQUFXLFNBQVNDLEdBQ2hCLE9BQTJCLElBQW5CVCxLQUFLVSxVQUNSRCxFQUFjVCxLQUFLVyxpQkFDbkJGLEdBQWVU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QUt3RixRQUlwQjhELFlBQWEsQ0FDVG5FLE1BQU8sUUFDUEYsS0FBTSxvQkFDTlYsU0FBVSw0REFDVnFCLFNBQVcsd0dBQ1hVLFNBQVUsU0FBU3RHLEdBQ2YsT0FBT0EsRUFBSzhFLFFBQVU5RSxFQUFLOEUsT0FBT3lFLFFBSTFDQyxTQUFVLENBQ05yRSxNQUFPLFdBQ1BGLEtBQU0saUJBQ05WLFNBQVUsNkJBQ1ZxQixTQUFVLEdBQ1ZwRixRQUFTLFFBR2JpSixTQUFVLENBQ050RSxNQUFPLFdBQ1BGLEtBQU0saUJBQ05WLFNBQVUsb0NBQ1ZxQixTQUFVLEdBQ1ZwRixRQUFTLFFBR2JrSixLQUFNLENBQ0Z2RSxNQUFPLE9BQ1BGLEtBQU0sZ0JBQ05WLFNBQVUsMENBQ1ZxQixTQUFVLElBR2QrRCxNQUFPLENBQ0h4RSxNQUFPLFFBQ1BGLEtBQU0sNkJBQ05WLFNBQVUsb0NBQ1ZxQixTQUFVLEdBQ1ZwRixRQUFTLFFBR2JvSixPQUFRLENBQ0p6RSxNQUFPLFNBQ1BGLEtBQU0sbUJBQ05WLFNBQVUscURBQ1ZxQixTQUFVLElBR2RpRSxVQUFXLENBQ1AxRSxNQUFPLFFBQ1BGLEtBQU0sbUJBQ05WLFNBQVUsa0NBQ1ZxQixTQUFVLEdBQ1ZwRixRQUFTLFFBRWJzSixJQUFLLENBQ0QzRSxNQUFPLE1BQ1BGLEtBQU0sWUFDTlYsU0FBVSxVQUNWcUIsU0FBVSxHQUNWcEYsUUFBUyxXQTlIckIsQ0FtSUUvQixPQUFRa0ssT0FBUWxLLE9BQU9xSiIsImZpbGUiOiJqc3NvY2lhbHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiEganNzb2NpYWxzIC0gdjEuNS4wIC0gMjAxNy0wNC0zMFxyXG4qIGh0dHA6Ly9qcy1zb2NpYWxzLmNvbVxyXG4qIENvcHlyaWdodCAoYykgMjAxNyBBcnRlbSBUYWJhbGluOyBMaWNlbnNlZCBNSVQgKi9cclxuKGZ1bmN0aW9uKHdpbmRvdywgJCwgdW5kZWZpbmVkKSB7XHJcblxyXG4gICAgdmFyIEpTU09DSUFMUyA9IFwiSlNTb2NpYWxzXCIsXHJcbiAgICAgICAgSlNTT0NJQUxTX0RBVEFfS0VZID0gSlNTT0NJQUxTO1xyXG5cclxuICAgIHZhciBnZXRPckFwcGx5ID0gZnVuY3Rpb24odmFsdWUsIGNvbnRleHQpIHtcclxuICAgICAgICBpZigkLmlzRnVuY3Rpb24odmFsdWUpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2YWx1ZS5hcHBseShjb250ZXh0LCAkLm1ha2VBcnJheShhcmd1bWVudHMpLnNsaWNlKDIpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgSU1HX1NSQ19SRUdFWCA9IC8oXFwuKGpwZWd8cG5nfGdpZnxibXB8c3ZnKSR8XmRhdGE6aW1hZ2VcXC8oanBlZ3xwbmd8Z2lmfGJtcHxzdmdcXCt4bWwpO2Jhc2U2NCkvaTtcclxuICAgIHZhciBVUkxfUEFSQU1TX1JFR0VYID0gLygmP1thLXpBLVowLTldKz0pP1xceyhbYS16QS1aMC05XSspXFx9L2c7XHJcblxyXG4gICAgdmFyIE1FQVNVUkVTID0ge1xyXG4gICAgICAgIFwiR1wiOiAxMDAwMDAwMDAwLFxyXG4gICAgICAgIFwiTVwiOiAxMDAwMDAwLFxyXG4gICAgICAgIFwiS1wiOiAxMDAwXHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBzaGFyZXMgPSB7fTtcclxuXHJcbiAgICBmdW5jdGlvbiBTb2NpYWxzKGVsZW1lbnQsIGNvbmZpZykge1xyXG4gICAgICAgIHZhciAkZWxlbWVudCA9ICQoZWxlbWVudCk7XHJcblxyXG4gICAgICAgICRlbGVtZW50LmRhdGEoSlNTT0NJQUxTX0RBVEFfS0VZLCB0aGlzKTtcclxuXHJcbiAgICAgICAgdGhpcy5fJGVsZW1lbnQgPSAkZWxlbWVudDtcclxuXHJcbiAgICAgICAgdGhpcy5zaGFyZXMgPSBbXTtcclxuXHJcbiAgICAgICAgdGhpcy5faW5pdChjb25maWcpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIFNvY2lhbHMucHJvdG90eXBlID0ge1xyXG4gICAgICAgIHVybDogXCJcIixcclxuICAgICAgICB0ZXh0OiBcIlwiLFxyXG4gICAgICAgIHNoYXJlSW46IFwiYmxhbmtcIixcclxuXHJcbiAgICAgICAgc2hvd0xhYmVsOiBmdW5jdGlvbihzY3JlZW5XaWR0aCkge1xyXG4gICAgICAgICAgICByZXR1cm4gKHRoaXMuc2hvd0NvdW50ID09PSBmYWxzZSkgP1xyXG4gICAgICAgICAgICAgICAgKHNjcmVlbldpZHRoID4gdGhpcy5zbWFsbFNjcmVlbldpZHRoKSA6XHJcbiAgICAgICAgICAgICAgICAoc2NyZWVuV2lkdGggPj0gdGhpcy5sYXJnZVNjcmVlbldpZHRoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzaG93Q291bnQ6IGZ1bmN0aW9uKHNjcmVlbldpZHRoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAoc2NyZWVuV2lkdGggPD0gdGhpcy5zbWFsbFNjcmVlbldpZHRoKSA/IFwiaW5zaWRlXCIgOiB0cnVlO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHNtYWxsU2NyZWVuV2lkdGg6IDY0MCxcclxuICAgICAgICBsYXJnZVNjcmVlbldpZHRoOiAxMDI0LFxyXG5cclxuICAgICAgICByZXNpemVUaW1lb3V0OiAyMDAsXHJcblxyXG4gICAgICAgIGVsZW1lbnRDbGFzczogXCJqc3NvY2lhbHNcIixcclxuICAgICAgICBzaGFyZXNDbGFzczogXCJqc3NvY2lhbHMtc2hhcmVzXCIsXHJcbiAgICAgICAgc2hhcmVDbGFzczogXCJqc3NvY2lhbHMtc2hhcmVcIixcclxuICAgICAgICBzaGFyZUJ1dHRvbkNsYXNzOiBcImpzc29jaWFscy1zaGFyZS1idXR0b25cIixcclxuICAgICAgICBzaGFyZUxpbmtDbGFzczogXCJqc3NvY2lhbHMtc2hhcmUtbGlua1wiLFxyXG4gICAgICAgIHNoYXJlTG9nb0NsYXNzOiBcImpzc29jaWFscy1zaGFyZS1sb2dvXCIsXHJcbiAgICAgICAgc2hhcmVMYWJlbENsYXNzOiBcImpzc29jaWFscy1zaGFyZS1sYWJlbFwiLFxyXG4gICAgICAgIHNoYXJlTGlua0NvdW50Q2xhc3M6IFwianNzb2NpYWxzLXNoYXJlLWxpbmstY291bnRcIixcclxuICAgICAgICBzaGFyZUNvdW50Qm94Q2xhc3M6IFwianNzb2NpYWxzLXNoYXJlLWNvdW50LWJveFwiLFxyXG4gICAgICAgIHNoYXJlQ291bnRDbGFzczogXCJqc3NvY2lhbHMtc2hhcmUtY291bnRcIixcclxuICAgICAgICBzaGFyZVplcm9Db3VudENsYXNzOiBcImpzc29jaWFscy1zaGFyZS1uby1jb3VudFwiLFxyXG5cclxuICAgICAgICBfaW5pdDogZnVuY3Rpb24oY29uZmlnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luaXREZWZhdWx0cygpO1xyXG4gICAgICAgICAgICAkLmV4dGVuZCh0aGlzLCBjb25maWcpO1xyXG4gICAgICAgICAgICB0aGlzLl9pbml0U2hhcmVzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2F0dGFjaFdpbmRvd1Jlc2l6ZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2luaXREZWZhdWx0czogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMudXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWY7XHJcbiAgICAgICAgICAgIHRoaXMudGV4dCA9ICQudHJpbSgkKFwibWV0YVtuYW1lPWRlc2NyaXB0aW9uXVwiKS5hdHRyKFwiY29udGVudFwiKSB8fCAkKFwidGl0bGVcIikudGV4dCgpKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfaW5pdFNoYXJlczogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2hhcmVzID0gJC5tYXAodGhpcy5zaGFyZXMsICQucHJveHkoZnVuY3Rpb24oc2hhcmVDb25maWcpIHtcclxuICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBzaGFyZUNvbmZpZyA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlQ29uZmlnID0geyBzaGFyZTogc2hhcmVDb25maWcgfTtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgc2hhcmUgPSAoc2hhcmVDb25maWcuc2hhcmUgJiYgc2hhcmVzW3NoYXJlQ29uZmlnLnNoYXJlXSk7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoIXNoYXJlICYmICFzaGFyZUNvbmZpZy5yZW5kZXJlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRocm93IEVycm9yKFwiU2hhcmUgJ1wiICsgc2hhcmVDb25maWcuc2hhcmUgKyBcIicgaXMgbm90IGZvdW5kXCIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHJldHVybiAkLmV4dGVuZCh7IHVybDogdGhpcy51cmwsIHRleHQ6IHRoaXMudGV4dCB9LCBzaGFyZSwgc2hhcmVDb25maWcpO1xyXG4gICAgICAgICAgICB9LCB0aGlzKSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2F0dGFjaFdpbmRvd1Jlc2l6ZUNhbGxiYWNrOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgJCh3aW5kb3cpLm9uKFwicmVzaXplXCIsICQucHJveHkodGhpcy5fd2luZG93UmVzaXplSGFuZGxlciwgdGhpcykpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9kZXRhY2hXaW5kb3dSZXNpemVDYWxsYmFjazogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICQod2luZG93KS5vZmYoXCJyZXNpemVcIiwgdGhpcy5fd2luZG93UmVzaXplSGFuZGxlcik7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX3dpbmRvd1Jlc2l6ZUhhbmRsZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpZigkLmlzRnVuY3Rpb24odGhpcy5zaG93TGFiZWwpIHx8ICQuaXNGdW5jdGlvbih0aGlzLnNob3dDb3VudCkpIHtcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGhpcy5fcmVzaXplVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzaXplVGltZXIgPSBzZXRUaW1lb3V0KCQucHJveHkodGhpcy5yZWZyZXNoLCB0aGlzKSwgdGhpcy5yZXNpemVUaW1lb3V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9yZW5kZXI6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jbGVhcigpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fZGVmaW5lT3B0aW9uc0J5U2NyZWVuKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl8kZWxlbWVudC5hZGRDbGFzcyh0aGlzLmVsZW1lbnRDbGFzcyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl8kc2hhcmVzID0gJChcIjxkaXY+XCIpLmFkZENsYXNzKHRoaXMuc2hhcmVzQ2xhc3MpXHJcbiAgICAgICAgICAgICAgICAuYXBwZW5kVG8odGhpcy5fJGVsZW1lbnQpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyU2hhcmVzKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2RlZmluZU9wdGlvbnNCeVNjcmVlbjogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NjcmVlbldpZHRoID0gJCh3aW5kb3cpLndpZHRoKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3Nob3dMYWJlbCA9IGdldE9yQXBwbHkodGhpcy5zaG93TGFiZWwsIHRoaXMsIHRoaXMuX3NjcmVlbldpZHRoKTtcclxuICAgICAgICAgICAgdGhpcy5fc2hvd0NvdW50ID0gZ2V0T3JBcHBseSh0aGlzLnNob3dDb3VudCwgdGhpcywgdGhpcy5fc2NyZWVuV2lkdGgpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9yZW5kZXJTaGFyZXM6IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkLmVhY2godGhpcy5zaGFyZXMsICQucHJveHkoZnVuY3Rpb24oXywgc2hhcmUpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX3JlbmRlclNoYXJlKHNoYXJlKTtcclxuICAgICAgICAgICAgfSwgdGhpcykpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9yZW5kZXJTaGFyZTogZnVuY3Rpb24oc2hhcmUpIHtcclxuICAgICAgICAgICAgdmFyICRzaGFyZTtcclxuXHJcbiAgICAgICAgICAgIGlmKCQuaXNGdW5jdGlvbihzaGFyZS5yZW5kZXJlcikpIHtcclxuICAgICAgICAgICAgICAgICRzaGFyZSA9ICQoc2hhcmUucmVuZGVyZXIoKSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkc2hhcmUgPSB0aGlzLl9jcmVhdGVTaGFyZShzaGFyZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRzaGFyZS5hZGRDbGFzcyh0aGlzLnNoYXJlQ2xhc3MpXHJcbiAgICAgICAgICAgICAgICAuYWRkQ2xhc3Moc2hhcmUuc2hhcmUgPyBcImpzc29jaWFscy1zaGFyZS1cIiArIHNoYXJlLnNoYXJlIDogXCJcIilcclxuICAgICAgICAgICAgICAgIC5hZGRDbGFzcyhzaGFyZS5jc3MpXHJcbiAgICAgICAgICAgICAgICAuYXBwZW5kVG8odGhpcy5fJHNoYXJlcyk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2NyZWF0ZVNoYXJlOiBmdW5jdGlvbihzaGFyZSkge1xyXG4gICAgICAgICAgICB2YXIgJHJlc3VsdCA9ICQoXCI8ZGl2PlwiKTtcclxuICAgICAgICAgICAgdmFyICRzaGFyZUxpbmsgPSB0aGlzLl9jcmVhdGVTaGFyZUxpbmsoc2hhcmUpLmFwcGVuZFRvKCRyZXN1bHQpO1xyXG5cclxuICAgICAgICAgICAgaWYodGhpcy5fc2hvd0NvdW50KSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXNJbnNpZGVDb3VudCA9ICh0aGlzLl9zaG93Q291bnQgPT09IFwiaW5zaWRlXCIpO1xyXG4gICAgICAgICAgICAgICAgdmFyICRjb3VudENvbnRhaW5lciA9IGlzSW5zaWRlQ291bnQgPyAkc2hhcmVMaW5rIDogJChcIjxkaXY+XCIpLmFkZENsYXNzKHRoaXMuc2hhcmVDb3VudEJveENsYXNzKS5hcHBlbmRUbygkcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgICRjb3VudENvbnRhaW5lci5hZGRDbGFzcyhpc0luc2lkZUNvdW50ID8gdGhpcy5zaGFyZUxpbmtDb3VudENsYXNzIDogdGhpcy5zaGFyZUNvdW50Qm94Q2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVuZGVyU2hhcmVDb3VudChzaGFyZSwgJGNvdW50Q29udGFpbmVyKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuICRyZXN1bHQ7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2NyZWF0ZVNoYXJlTGluazogZnVuY3Rpb24oc2hhcmUpIHtcclxuICAgICAgICAgICAgdmFyIHNoYXJlU3RyYXRlZ3kgPSB0aGlzLl9nZXRTaGFyZVN0cmF0ZWd5KHNoYXJlKTtcclxuXHJcbiAgICAgICAgICAgIHZhciAkcmVzdWx0ID0gc2hhcmVTdHJhdGVneS5jYWxsKHNoYXJlLCB7XHJcbiAgICAgICAgICAgICAgICBzaGFyZVVybDogdGhpcy5fZ2V0U2hhcmVVcmwoc2hhcmUpXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJHJlc3VsdC5hZGRDbGFzcyh0aGlzLnNoYXJlTGlua0NsYXNzKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZCh0aGlzLl9jcmVhdGVTaGFyZUxvZ28oc2hhcmUpKTtcclxuXHJcbiAgICAgICAgICAgIGlmKHRoaXMuX3Nob3dMYWJlbCkge1xyXG4gICAgICAgICAgICAgICAgJHJlc3VsdC5hcHBlbmQodGhpcy5fY3JlYXRlU2hhcmVMYWJlbChzaGFyZSkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkLmVhY2godGhpcy5vbiB8fCB7fSwgZnVuY3Rpb24oZXZlbnQsIGhhbmRsZXIpIHtcclxuICAgICAgICAgICAgICAgIGlmKCQuaXNGdW5jdGlvbihoYW5kbGVyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICRyZXN1bHQub24oZXZlbnQsICQucHJveHkoaGFuZGxlciwgc2hhcmUpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gJHJlc3VsdDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfZ2V0U2hhcmVTdHJhdGVneTogZnVuY3Rpb24oc2hhcmUpIHtcclxuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IHNoYXJlU3RyYXRlZ2llc1tzaGFyZS5zaGFyZUluIHx8IHRoaXMuc2hhcmVJbl07XHJcblxyXG4gICAgICAgICAgICBpZighcmVzdWx0KVxyXG4gICAgICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJTaGFyZSBzdHJhdGVneSAnXCIgKyB0aGlzLnNoYXJlSW4gKyBcIicgbm90IGZvdW5kXCIpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfZ2V0U2hhcmVVcmw6IGZ1bmN0aW9uKHNoYXJlKSB7XHJcbiAgICAgICAgICAgIHZhciBzaGFyZVVybCA9IGdldE9yQXBwbHkoc2hhcmUuc2hhcmVVcmwsIHNoYXJlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1hdFNoYXJlVXJsKHNoYXJlVXJsLCBzaGFyZSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2NyZWF0ZVNoYXJlTG9nbzogZnVuY3Rpb24oc2hhcmUpIHtcclxuICAgICAgICAgICAgdmFyIGxvZ28gPSBzaGFyZS5sb2dvO1xyXG5cclxuICAgICAgICAgICAgdmFyICRyZXN1bHQgPSBJTUdfU1JDX1JFR0VYLnRlc3QobG9nbykgP1xyXG4gICAgICAgICAgICAgICAgJChcIjxpbWc+XCIpLmF0dHIoXCJzcmNcIiwgc2hhcmUubG9nbykgOlxyXG4gICAgICAgICAgICAgICAgJChcIjxpPlwiKS5hZGRDbGFzcyhsb2dvKTtcclxuXHJcbiAgICAgICAgICAgICRyZXN1bHQuYWRkQ2xhc3ModGhpcy5zaGFyZUxvZ29DbGFzcyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gJHJlc3VsdDtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfY3JlYXRlU2hhcmVMYWJlbDogZnVuY3Rpb24oc2hhcmUpIHtcclxuICAgICAgICAgICAgcmV0dXJuICQoXCI8c3Bhbj5cIikuYWRkQ2xhc3ModGhpcy5zaGFyZUxhYmVsQ2xhc3MpXHJcbiAgICAgICAgICAgICAgICAudGV4dChzaGFyZS5sYWJlbCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX3JlbmRlclNoYXJlQ291bnQ6IGZ1bmN0aW9uKHNoYXJlLCAkY29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIHZhciAkY291bnQgPSAkKFwiPHNwYW4+XCIpLmFkZENsYXNzKHRoaXMuc2hhcmVDb3VudENsYXNzKTtcclxuXHJcbiAgICAgICAgICAgICRjb250YWluZXIuYWRkQ2xhc3ModGhpcy5zaGFyZVplcm9Db3VudENsYXNzKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZCgkY291bnQpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fbG9hZENvdW50KHNoYXJlKS5kb25lKCQucHJveHkoZnVuY3Rpb24oY291bnQpIHtcclxuICAgICAgICAgICAgICAgIGlmKGNvdW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGNvbnRhaW5lci5yZW1vdmVDbGFzcyh0aGlzLnNoYXJlWmVyb0NvdW50Q2xhc3MpO1xyXG4gICAgICAgICAgICAgICAgICAgICRjb3VudC50ZXh0KGNvdW50KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSwgdGhpcykpO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9sb2FkQ291bnQ6IGZ1bmN0aW9uKHNoYXJlKSB7XHJcbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICQuRGVmZXJyZWQoKTtcclxuICAgICAgICAgICAgdmFyIGNvdW50VXJsID0gdGhpcy5fZ2V0Q291bnRVcmwoc2hhcmUpO1xyXG5cclxuICAgICAgICAgICAgaWYoIWNvdW50VXJsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucmVzb2x2ZSgwKS5wcm9taXNlKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBoYW5kbGVTdWNjZXNzID0gJC5wcm94eShmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZSh0aGlzLl9nZXRDb3VudFZhbHVlKHJlc3BvbnNlLCBzaGFyZSkpO1xyXG4gICAgICAgICAgICB9LCB0aGlzKTtcclxuXHJcbiAgICAgICAgICAgICQuZ2V0SlNPTihjb3VudFVybCkuZG9uZShoYW5kbGVTdWNjZXNzKVxyXG4gICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJC5nZXQoY291bnRVcmwpLmRvbmUoaGFuZGxlU3VjY2VzcylcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmZhaWwoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKDApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2UoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfZ2V0Q291bnRVcmw6IGZ1bmN0aW9uKHNoYXJlKSB7XHJcbiAgICAgICAgICAgIHZhciBjb3VudFVybCA9IGdldE9yQXBwbHkoc2hhcmUuY291bnRVcmwsIHNoYXJlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2Zvcm1hdFNoYXJlVXJsKGNvdW50VXJsLCBzaGFyZSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2dldENvdW50VmFsdWU6IGZ1bmN0aW9uKHJlc3BvbnNlLCBzaGFyZSkge1xyXG4gICAgICAgICAgICB2YXIgY291bnQgPSAoJC5pc0Z1bmN0aW9uKHNoYXJlLmdldENvdW50KSA/IHNoYXJlLmdldENvdW50KHJlc3BvbnNlKSA6IHJlc3BvbnNlKSB8fCAwO1xyXG4gICAgICAgICAgICByZXR1cm4gKHR5cGVvZiBjb3VudCA9PT0gXCJzdHJpbmdcIikgPyBjb3VudCA6IHRoaXMuX2Zvcm1hdE51bWJlcihjb3VudCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2Zvcm1hdE51bWJlcjogZnVuY3Rpb24obnVtYmVyKSB7XHJcbiAgICAgICAgICAgICQuZWFjaChNRUFTVVJFUywgZnVuY3Rpb24obGV0dGVyLCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgaWYobnVtYmVyID49IHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbnVtYmVyID0gcGFyc2VGbG9hdCgobnVtYmVyIC8gdmFsdWUpLnRvRml4ZWQoMikpICsgbGV0dGVyO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbnVtYmVyO1xyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIF9mb3JtYXRTaGFyZVVybDogZnVuY3Rpb24odXJsLCBzaGFyZSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdXJsLnJlcGxhY2UoVVJMX1BBUkFNU19SRUdFWCwgZnVuY3Rpb24obWF0Y2gsIGtleSwgZmllbGQpIHtcclxuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IHNoYXJlW2ZpZWxkXSB8fCBcIlwiO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlID8gKGtleSB8fCBcIlwiKSArIHdpbmRvdy5lbmNvZGVVUklDb21wb25lbnQodmFsdWUpIDogXCJcIjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX2NsZWFyOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dCh0aGlzLl9yZXNpemVUaW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50LmVtcHR5KCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgX3Bhc3NPcHRpb25Ub1NoYXJlczogZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICB2YXIgc2hhcmVzID0gdGhpcy5zaGFyZXM7XHJcblxyXG4gICAgICAgICAgICAkLmVhY2goW1widXJsXCIsIFwidGV4dFwiXSwgZnVuY3Rpb24oXywgb3B0aW9uTmFtZSkge1xyXG4gICAgICAgICAgICAgICAgaWYob3B0aW9uTmFtZSAhPT0ga2V5KVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgICAgICAkLmVhY2goc2hhcmVzLCBmdW5jdGlvbihfLCBzaGFyZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHNoYXJlW2tleV0gPSB2YWx1ZTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBfbm9ybWFsaXplU2hhcmU6IGZ1bmN0aW9uKHNoYXJlKSB7XHJcbiAgICAgICAgICAgIGlmKCQuaXNOdW1lcmljKHNoYXJlKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2hhcmVzW3NoYXJlXTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYodHlwZW9mIHNoYXJlID09PSBcInN0cmluZ1wiKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJC5ncmVwKHRoaXMuc2hhcmVzLCBmdW5jdGlvbihzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHMuc2hhcmUgPT09IHNoYXJlO1xyXG4gICAgICAgICAgICAgICAgfSlbMF07XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiBzaGFyZTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICByZWZyZXNoOiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVuZGVyKCk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgZGVzdHJveTogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2NsZWFyKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2RldGFjaFdpbmRvd1Jlc2l6ZUNhbGxiYWNrKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl8kZWxlbWVudFxyXG4gICAgICAgICAgICAgICAgLnJlbW92ZUNsYXNzKHRoaXMuZWxlbWVudENsYXNzKVxyXG4gICAgICAgICAgICAgICAgLnJlbW92ZURhdGEoSlNTT0NJQUxTX0RBVEFfS0VZKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBvcHRpb246IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgaWYoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXNba2V5XTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpc1trZXldID0gdmFsdWU7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9wYXNzT3B0aW9uVG9TaGFyZXMoa2V5LCB2YWx1ZSk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzaGFyZU9wdGlvbjogZnVuY3Rpb24oc2hhcmUsIGtleSwgdmFsdWUpIHtcclxuICAgICAgICAgICAgc2hhcmUgPSB0aGlzLl9ub3JtYWxpemVTaGFyZShzaGFyZSk7XHJcblxyXG4gICAgICAgICAgICBpZihhcmd1bWVudHMubGVuZ3RoID09PSAyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gc2hhcmVba2V5XTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2hhcmVba2V5XSA9IHZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuXHJcbiAgICAkLmZuLmpzU29jaWFscyA9IGZ1bmN0aW9uKGNvbmZpZykge1xyXG4gICAgICAgIHZhciBhcmdzID0gJC5tYWtlQXJyYXkoYXJndW1lbnRzKSxcclxuICAgICAgICAgICAgbWV0aG9kQXJncyA9IGFyZ3Muc2xpY2UoMSksXHJcbiAgICAgICAgICAgIHJlc3VsdCA9IHRoaXM7XHJcblxyXG4gICAgICAgIHRoaXMuZWFjaChmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdmFyICRlbGVtZW50ID0gJCh0aGlzKSxcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlID0gJGVsZW1lbnQuZGF0YShKU1NPQ0lBTFNfREFUQV9LRVkpLFxyXG4gICAgICAgICAgICAgICAgbWV0aG9kUmVzdWx0O1xyXG5cclxuICAgICAgICAgICAgaWYoaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBjb25maWcgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBtZXRob2RSZXN1bHQgPSBpbnN0YW5jZVtjb25maWddLmFwcGx5KGluc3RhbmNlLCBtZXRob2RBcmdzKTtcclxuICAgICAgICAgICAgICAgICAgICBpZihtZXRob2RSZXN1bHQgIT09IHVuZGVmaW5lZCAmJiBtZXRob2RSZXN1bHQgIT09IGluc3RhbmNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IG1ldGhvZFJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuX2RldGFjaFdpbmRvd1Jlc2l6ZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UuX2luaXQoY29uZmlnKTtcclxuICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5fcmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBuZXcgU29jaWFscygkZWxlbWVudCwgY29uZmlnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgc2V0RGVmYXVsdHMgPSBmdW5jdGlvbihjb25maWcpIHtcclxuICAgICAgICB2YXIgY29tcG9uZW50O1xyXG5cclxuICAgICAgICBpZigkLmlzUGxhaW5PYmplY3QoY29uZmlnKSkge1xyXG4gICAgICAgICAgICBjb21wb25lbnQgPSBTb2NpYWxzLnByb3RvdHlwZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBjb21wb25lbnQgPSBzaGFyZXNbY29uZmlnXTtcclxuICAgICAgICAgICAgY29uZmlnID0gYXJndW1lbnRzWzFdIHx8IHt9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJC5leHRlbmQoY29tcG9uZW50LCBjb25maWcpO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgc2hhcmVTdHJhdGVnaWVzID0ge1xyXG4gICAgICAgIHBvcHVwOiBmdW5jdGlvbihhcmdzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkKFwiPGE+XCIpLmF0dHIoXCJocmVmXCIsIFwiI1wiKVxyXG4gICAgICAgICAgICAgICAgLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oYXJncy5zaGFyZVVybCwgbnVsbCwgXCJ3aWR0aD02MDAsIGhlaWdodD00MDAsIGxvY2F0aW9uPTAsIG1lbnViYXI9MCwgcmVzaXplYWJsZT0wLCBzY3JvbGxiYXJzPTAsIHN0YXR1cz0wLCB0aXRsZWJhcj0wLCB0b29sYmFyPTBcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgYmxhbms6IGZ1bmN0aW9uKGFyZ3MpIHtcclxuICAgICAgICAgICAgcmV0dXJuICQoXCI8YT5cIikuYXR0cih7IHRhcmdldDogXCJfYmxhbmtcIiwgaHJlZjogYXJncy5zaGFyZVVybCB9KTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzZWxmOiBmdW5jdGlvbihhcmdzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkKFwiPGE+XCIpLmF0dHIoeyB0YXJnZXQ6IFwiX3NlbGZcIiwgaHJlZjogYXJncy5zaGFyZVVybCB9KTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHdpbmRvdy5qc1NvY2lhbHMgPSB7XHJcbiAgICAgICAgU29jaWFsczogU29jaWFscyxcclxuICAgICAgICBzaGFyZXM6IHNoYXJlcyxcclxuICAgICAgICBzaGFyZVN0cmF0ZWdpZXM6IHNoYXJlU3RyYXRlZ2llcyxcclxuICAgICAgICBzZXREZWZhdWx0czogc2V0RGVmYXVsdHNcclxuICAgIH07XHJcblxyXG59KHdpbmRvdywgalF1ZXJ5KSk7XHJcblxyXG5cclxuKGZ1bmN0aW9uKHdpbmRvdywgJCwganNTb2NpYWxzLCB1bmRlZmluZWQpIHtcclxuXHJcbiAgICAkLmV4dGVuZChqc1NvY2lhbHMuc2hhcmVzLCB7XHJcblxyXG4gICAgICAgIGVtYWlsOiB7XHJcbiAgICAgICAgICAgIGxhYmVsOiBcIkUtbWFpbFwiLFxyXG4gICAgICAgICAgICBsb2dvOiBcImZhIGZhLWF0XCIsXHJcbiAgICAgICAgICAgIHNoYXJlVXJsOiBcIm1haWx0bzp7dG99P3N1YmplY3Q9e3RleHR9JmJvZHk9e3VybH1cIixcclxuICAgICAgICAgICAgY291bnRVcmw6IFwiXCIsXHJcbiAgICAgICAgICAgIHNoYXJlSW46IFwic2VsZlwiXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgdHdpdHRlcjoge1xyXG4gICAgICAgICAgICBsYWJlbDogXCJUd2VldFwiLFxyXG4gICAgICAgICAgICBsb2dvOiBcImZhIGZhLXR3aXR0ZXJcIixcclxuICAgICAgICAgICAgc2hhcmVVcmw6IFwiaHR0cHM6Ly90d2l0dGVyLmNvbS9zaGFyZT91cmw9e3VybH0mdGV4dD17dGV4dH0mdmlhPXt2aWF9Jmhhc2h0YWdzPXtoYXNodGFnc31cIixcclxuICAgICAgICAgICAgY291bnRVcmw6IFwiXCJcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBmYWNlYm9vazoge1xyXG4gICAgICAgICAgICBsYWJlbDogXCJMaWtlXCIsXHJcbiAgICAgICAgICAgIGxvZ286IFwiZmEgZmEtZmFjZWJvb2tcIixcclxuICAgICAgICAgICAgc2hhcmVVcmw6IFwiaHR0cHM6Ly9mYWNlYm9vay5jb20vc2hhcmVyL3NoYXJlci5waHA/dT17dXJsfVwiLFxyXG4gICAgICAgICAgICBjb3VudFVybDogXCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8/aWQ9e3VybH1cIixcclxuICAgICAgICAgICAgZ2V0Q291bnQ6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLnNoYXJlICYmIGRhdGEuc2hhcmUuc2hhcmVfY291bnQgfHwgMDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHZrb250YWt0ZToge1xyXG4gICAgICAgICAgICBsYWJlbDogXCJMaWtlXCIsXHJcbiAgICAgICAgICAgIGxvZ286IFwiZmEgZmEtdmtcIixcclxuICAgICAgICAgICAgc2hhcmVVcmw6IFwiaHR0cHM6Ly92ay5jb20vc2hhcmUucGhwP3VybD17dXJsfSZ0aXRsZT17dGl0bGV9JmRlc2NyaXB0aW9uPXt0ZXh0fVwiLFxyXG4gICAgICAgICAgICBjb3VudFVybDogXCJodHRwczovL3ZrLmNvbS9zaGFyZS5waHA/YWN0PWNvdW50JmluZGV4PTEmdXJsPXt1cmx9XCIsXHJcbiAgICAgICAgICAgIGdldENvdW50OiBmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyc2VJbnQoZGF0YS5zbGljZSgxNSwgLTIpLnNwbGl0KCcsICcpWzFdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIGdvb2dsZXBsdXM6IHtcclxuICAgICAgICAgICAgbGFiZWw6IFwiKzFcIixcclxuICAgICAgICAgICAgbG9nbzogXCJmYSBmYS1nb29nbGVcIixcclxuICAgICAgICAgICAgc2hhcmVVcmw6IFwiaHR0cHM6Ly9wbHVzLmdvb2dsZS5jb20vc2hhcmU/dXJsPXt1cmx9XCIsXHJcbiAgICAgICAgICAgIGNvdW50VXJsOiBcIlwiXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbGlua2VkaW46IHtcclxuICAgICAgICAgICAgbGFiZWw6IFwiU2hhcmVcIixcclxuICAgICAgICAgICAgbG9nbzogXCJmYSBmYS1saW5rZWRpblwiLFxyXG4gICAgICAgICAgICBzaGFyZVVybDogXCJodHRwczovL3d3dy5saW5rZWRpbi5jb20vc2hhcmVBcnRpY2xlP21pbmk9dHJ1ZSZ1cmw9e3VybH1cIixcclxuICAgICAgICAgICAgY291bnRVcmw6IFwiaHR0cHM6Ly93d3cubGlua2VkaW4uY29tL2NvdW50c2Vydi9jb3VudC9zaGFyZT9mb3JtYXQ9anNvbnAmdXJsPXt1cmx9JmNhbGxiYWNrPT9cIixcclxuICAgICAgICAgICAgZ2V0Q291bnQ6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLmNvdW50O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgcGludGVyZXN0OiB7XHJcbiAgICAgICAgICAgIGxhYmVsOiBcIlBpbiBpdFwiLFxyXG4gICAgICAgICAgICBsb2dvOiBcImZhIGZhLXBpbnRlcmVzdFwiLFxyXG4gICAgICAgICAgICBzaGFyZVVybDogXCJodHRwczovL3BpbnRlcmVzdC5jb20vcGluL2NyZWF0ZS9ib29rbWFya2xldC8/bWVkaWE9e21lZGlhfSZ1cmw9e3VybH0mZGVzY3JpcHRpb249e3RleHR9XCIsXHJcbiAgICAgICAgICAgIGNvdW50VXJsOiBcImh0dHBzOi8vYXBpLnBpbnRlcmVzdC5jb20vdjEvdXJscy9jb3VudC5qc29uPyZ1cmw9e3VybH0mY2FsbGJhY2s9P1wiLFxyXG4gICAgICAgICAgICBnZXRDb3VudDogZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRhdGEuY291bnQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzdHVtYmxldXBvbjoge1xyXG4gICAgICAgICAgICBsYWJlbDogXCJTaGFyZVwiLFxyXG4gICAgICAgICAgICBsb2dvOiBcImZhIGZhLXN0dW1ibGV1cG9uXCIsXHJcbiAgICAgICAgICAgIHNoYXJlVXJsOiBcImh0dHA6Ly93d3cuc3R1bWJsZXVwb24uY29tL3N1Ym1pdD91cmw9e3VybH0mdGl0bGU9e3RpdGxlfVwiLFxyXG4gICAgICAgICAgICBjb3VudFVybDogIFwiaHR0cHM6Ly9jb3JzLWFueXdoZXJlLmhlcm9rdWFwcC5jb20vaHR0cHM6Ly93d3cuc3R1bWJsZXVwb24uY29tL3NlcnZpY2VzLzEuMDEvYmFkZ2UuZ2V0aW5mbz91cmw9e3VybH1cIixcclxuICAgICAgICAgICAgZ2V0Q291bnQ6IGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBkYXRhLnJlc3VsdCAmJiBkYXRhLnJlc3VsdC52aWV3cztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIHRlbGVncmFtOiB7XHJcbiAgICAgICAgICAgIGxhYmVsOiBcIlRlbGVncmFtXCIsXHJcbiAgICAgICAgICAgIGxvZ286IFwiZmEgZmEtdGVsZWdyYW1cIixcclxuICAgICAgICAgICAgc2hhcmVVcmw6IFwidGc6Ly9tc2c/dGV4dD17dXJsfSB7dGV4dH1cIixcclxuICAgICAgICAgICAgY291bnRVcmw6IFwiXCIsXHJcbiAgICAgICAgICAgIHNoYXJlSW46IFwic2VsZlwiXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgd2hhdHNhcHA6IHtcclxuICAgICAgICAgICAgbGFiZWw6IFwiV2hhdHNBcHBcIixcclxuICAgICAgICAgICAgbG9nbzogXCJmYSBmYS13aGF0c2FwcFwiLFxyXG4gICAgICAgICAgICBzaGFyZVVybDogXCJ3aGF0c2FwcDovL3NlbmQ/dGV4dD17dXJsfSB7dGV4dH1cIixcclxuICAgICAgICAgICAgY291bnRVcmw6IFwiXCIsXHJcbiAgICAgICAgICAgIHNoYXJlSW46IFwic2VsZlwiXHJcbiAgICAgICAgfSxcclxuXHJcbiAgICAgICAgbGluZToge1xyXG4gICAgICAgICAgICBsYWJlbDogXCJMSU5FXCIsXHJcbiAgICAgICAgICAgIGxvZ286IFwiZmEgZmEtY29tbWVudFwiLFxyXG4gICAgICAgICAgICBzaGFyZVVybDogXCJodHRwOi8vbGluZS5tZS9SL21zZy90ZXh0Lz97dGV4dH0ge3VybH1cIixcclxuICAgICAgICAgICAgY291bnRVcmw6IFwiXCJcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICB2aWJlcjoge1xyXG4gICAgICAgICAgICBsYWJlbDogXCJWaWJlclwiLFxyXG4gICAgICAgICAgICBsb2dvOiBcImZhIGZhLXZvbHVtZS1jb250cm9sLXBob25lXCIsXHJcbiAgICAgICAgICAgIHNoYXJlVXJsOiBcInZpYmVyOi8vZm9yd2FyZD90ZXh0PXt1cmx9IHt0ZXh0fVwiLFxyXG4gICAgICAgICAgICBjb3VudFVybDogXCJcIixcclxuICAgICAgICAgICAgc2hhcmVJbjogXCJzZWxmXCJcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBwb2NrZXQ6IHtcclxuICAgICAgICAgICAgbGFiZWw6IFwiUG9ja2V0XCIsXHJcbiAgICAgICAgICAgIGxvZ286IFwiZmEgZmEtZ2V0LXBvY2tldFwiLFxyXG4gICAgICAgICAgICBzaGFyZVVybDogXCJodHRwczovL2dldHBvY2tldC5jb20vc2F2ZT91cmw9e3VybH0mdGl0bGU9e3RpdGxlfVwiLFxyXG4gICAgICAgICAgICBjb3VudFVybDogXCJcIlxyXG4gICAgICAgIH0sXHJcblxyXG4gICAgICAgIG1lc3Nlbmdlcjoge1xyXG4gICAgICAgICAgICBsYWJlbDogXCJTaGFyZVwiLFxyXG4gICAgICAgICAgICBsb2dvOiBcImZhIGZhLWNvbW1lbnRpbmdcIixcclxuICAgICAgICAgICAgc2hhcmVVcmw6IFwiZmItbWVzc2VuZ2VyOi8vc2hhcmU/bGluaz17dXJsfVwiLFxyXG4gICAgICAgICAgICBjb3VudFVybDogXCJcIixcclxuICAgICAgICAgICAgc2hhcmVJbjogXCJzZWxmXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIHJzczoge1xyXG4gICAgICAgICAgICBsYWJlbDogXCJSU1NcIixcclxuICAgICAgICAgICAgbG9nbzogXCJmYSBmYS1yc3NcIixcclxuICAgICAgICAgICAgc2hhcmVVcmw6IFwiL2ZlZWRzL1wiLFxyXG4gICAgICAgICAgICBjb3VudFVybDogXCJcIixcclxuICAgICAgICAgICAgc2hhcmVJbjogXCJibGFua1wiXHJcbiAgICAgICAgfVxyXG5cclxuICAgIH0pO1xyXG5cclxufSh3aW5kb3csIGpRdWVyeSwgd2luZG93LmpzU29jaWFscykpO1xyXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
