!function(){function n(t){l.call(this,t),this.hintContainer=this.codeContainer=null}var l=ToolbarConfigurator.AbstractToolbarModifier,u=ToolbarConfigurator.FullToolbarEditor;((ToolbarConfigurator.ToolbarTextModifier=n).prototype=Object.create(l.prototype))._onInit=function(t,o){l.prototype._onInit.call(this,void 0,o),this._createModifier(o?this.actualConfig:void 0),"function"==typeof t&&t(this.mainContainer)},n.prototype._createModifier=function(t){function o(t){if(null!==(r=a(t)).charsBetween){var o=s.getUnusedButtonsArray(s.actualConfig.toolbar,!0,r.charsBetween),e=t.getCursor(),r=CodeMirror.Pos(e.line,e.ch-r.charsBetween.length),n=t.getTokenAt(e);if("{"===t.getTokenAt({line:e.line,ch:n.start}).string&&(o=["name"]),0!==o.length)return new i(r,e,o)}}function i(t,o,e){this.from=t,this.to=o,this.list=e,this._handlers=[]}function a(t,o){var e={};e.cur=t.getCursor(),e.tok=t.getTokenAt(e.cur),e.char=o||e.tok.string.charAt(e.tok.string.length-1);var r=(r=t.getRange(CodeMirror.Pos(e.cur.line,0),e.cur).split("").reverse().join("")).replace(/(['|"]\w*['|"])/g,"");return e.charsBetween=r.match(/(^\w*)(['|"])/),e.charsBetween&&(e.endChar=e.charsBetween[2],e.charsBetween=e.charsBetween[1].split("").reverse().join("")),e}function e(t){return setTimeout(function(){t.state.completionActive||CodeMirror.showHint(t,o,{hintsClass:"toolbar-modifier",completeSingle:!1})},100),CodeMirror.Pass}var s=this;this._createToolbar(),this.toolbarContainer&&this.mainContainer.append(this.toolbarContainer),l.prototype._createModifier.call(this),this._setupActualConfig(t),t=this.actualConfig.toolbar,t=["CKEDITOR.editorConfig = function( config ) {\n",t=CKEDITOR.tools.isArray(t)?"\tconfig.toolbar = [\n\t\t"+u.map(t,function(t){return l.stringifyJSONintoOneLine(t,{addSpaces:!0,noQuotesOnKey:!0,singleQuotes:!0})}).join(",\n\t\t")+"\n\t];":"config.toolbar = [];","\n};"].join("");var r=new CKEDITOR.dom.element("div");r.addClass("codemirror-wrapper"),this.modifyContainer.append(r),this.codeContainer=CodeMirror(r.$,{mode:{name:"javascript",json:!0},lineNumbers:!1,lineWrapping:!0,viewportMargin:1/0,value:t,smartIndent:!1,indentWithTabs:!0,indentUnit:4,tabSize:4,theme:"neo",extraKeys:{Left:e,Right:e,"'''":e,"'\"'":e,Backspace:e,Delete:e,"Shift-Tab":"indentLess"}}),this.codeContainer.on("endCompletion",function(t,o){var e=a(t);void 0!==o&&t.replaceSelection(e.endChar)}),this.codeContainer.on("change",function(){var t=s.codeContainer.getValue();null!==(t=s._evaluateValue(t))?(s.actualConfig.toolbar=t.toolbar?t.toolbar:s.actualConfig.toolbar,s._fillHintByUnusedElements(),s._refreshEditor(),s.mainContainer.removeClass("invalid")):s.mainContainer.addClass("invalid")}),this.hintContainer=new CKEDITOR.dom.element("div"),this.hintContainer.addClass("toolbarModifier-hints"),this._fillHintByUnusedElements(),this.hintContainer.insertBefore(r)},n.prototype._fillHintByUnusedElements=function(){var t=this.getUnusedButtonsArray(this.actualConfig.toolbar,!0),o=(t=this.groupButtonNamesByGroup(t),u.map(t,function(t){var o=u.map(t.buttons,function(t){return"<code>"+t+"</code> "}).join("");return["<dt><code>",t.name,"</code></dt><dd>",o,"</dd>"].join("")}).join(" ")),e='<dt class="list-header">Toolbar group</dt><dd class="list-header">Unused items</dd>';t.length||(e="<p>All items are in use.</p>"),this.codeContainer.refresh(),this.hintContainer.setHtml("<h3>Unused toolbar items</h3><dl>"+e+o+"</dl>")},n.prototype.getToolbarGroupByButtonName=function(t){var o,e=this.fullToolbarEditor.buttonNamesByGroup;for(o in e)for(var r=e[o],n=r.length;n--;)if(t===r[n])return o;return null},n.prototype.getUnusedButtonsArray=function(t,o,e){o=!0===o;var r=n.mapToolbarCfgToElementsList(t);return t=Object.keys(this.fullToolbarEditor.editorInstance.ui.items),t=u.filter(t,function(t){var o="-"===t;return t=void 0===e||0===t.toLowerCase().indexOf(e.toLowerCase()),!o&&t}),t=u.filter(t,function(t){return-1==CKEDITOR.tools.indexOf(r,t)}),o&&t.sort(),t},n.prototype.groupButtonNamesByGroup=function(o){var t,e=[],r=JSON.parse(JSON.stringify(this.fullToolbarEditor.buttonNamesByGroup));for(t in r){var n=r[t];(n=u.filter(n,function(t){return-1!==CKEDITOR.tools.indexOf(o,t)})).length&&e.push({name:t,buttons:n})}return e},n.mapToolbarCfgToElementsList=function(t){function o(t){return"-"!==t}for(var e=[],r=t.length,n=0;n<r;n+=1)t[n]&&"string"!=typeof t[n]&&(e=e.concat(u.filter(t[n].items,o)));return e},n.prototype._setupActualConfig=function(t){t=t||this.editorInstance.config,CKEDITOR.tools.isArray(t.toolbar)||(t.toolbarGroups||(t.toolbarGroups=this.fullToolbarEditor.getFullToolbarGroupsConfig(!0)),this._fixGroups(t),t.toolbar=this._mapToolbarGroupsToToolbar(t.toolbarGroups,this.actualConfig.removeButtons),this.actualConfig.toolbar=t.toolbar,this.actualConfig.removeButtons="")},n.prototype._mapToolbarGroupsToToolbar=function(t,o){o="string"==typeof(o=o||this.editorInstance.config.removedBtns)?o.split(","):[];for(var e=t.length;e--;){var r=this._mapToolbarSubgroup(t[e],o);"separator"===t[e].type?t[e]="/":CKEDITOR.tools.isArray(r)&&0===r.length?t.splice(e,1):t[e]="string"==typeof r?r:{name:t[e].name,items:r}}return t},n.prototype._mapToolbarSubgroup=function(t,o){if("string"==typeof t)return t;for(var e=t.groups?t.groups.length:0,r=[],n=0;n<e;n+=1){var i=t.groups[n],a=(i=this.fullToolbarEditor.buttonsByGroup["string"==typeof i?i:i.name]||[],(i=this._mapButtonsToButtonsNames(i,o)).length);r=r.concat(i);a&&r.push("-")}return"-"==r[r.length-1]&&r.pop(),r},n.prototype._mapButtonsToButtonsNames=function(t,o){for(var e=t.length;e--;){var r="string"==typeof(r=t[e])?r:this.fullToolbarEditor.getCamelCasedButtonName(r.name);-1!==CKEDITOR.tools.indexOf(o,r)?t.splice(e,1):t[e]=r}return t},n.prototype._evaluateValue=function(t){var o;try{var e={};Function("var CKEDITOR = {}; "+t+"; return CKEDITOR;")().editorConfig(e);for(var r=(o=e).toolbar.length;r--;)o.toolbar[r]||o.toolbar.splice(r,1)}catch(t){o=null}return o},n.prototype.mapToolbarToToolbarGroups=function(t){function a(t,o){t=t.slice();for(var e=o.length;e--;){var r=t.indexOf(o[e]);-1!==r&&t.splice(r,1)}return t}for(var o={},e=[],r=[],n=(e=t.length,0);n<e;n++)if("/"===t[n])r.push("/");else{var i=t[n].items,s={};s.name=t[n].name,s.groups=[];for(var l=i.length,u=0;u<l;u++){var c=i[u];if("-"!==c){var f=this.getToolbarGroupByButtonName(c);-1===s.groups.indexOf(f)&&s.groups.push(f),o[f]=o[f]||{},(f=o[f].buttons=o[f].buttons||{})[c]=f[c]||{used:0,origin:s.name},f[c].used++}}r.push(s)}return{toolbarGroups:r,removeButtons:(e=function(t,o){var e,r=[];for(e in t){var n=t[e],i=o[e].slice();r=r.concat(a(i,Object.keys(n.buttons)))}return r}(o,this.fullToolbarEditor.buttonNamesByGroup)).join(",")}}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNrZWRpdG9yL3NhbXBsZXMvdG9vbGJhcmNvbmZpZ3VyYXRvci9qcy90b29sYmFydGV4dG1vZGlmaWVyLmpzIl0sIm5hbWVzIjpbImUiLCJhIiwibCIsImNhbGwiLCJ0aGlzIiwiaGludENvbnRhaW5lciIsImNvZGVDb250YWluZXIiLCJUb29sYmFyQ29uZmlndXJhdG9yIiwiQWJzdHJhY3RUb29sYmFyTW9kaWZpZXIiLCJnIiwiRnVsbFRvb2xiYXJFZGl0b3IiLCJUb29sYmFyVGV4dE1vZGlmaWVyIiwicHJvdG90eXBlIiwiT2JqZWN0IiwiY3JlYXRlIiwiX29uSW5pdCIsImQiLCJfY3JlYXRlTW9kaWZpZXIiLCJhY3R1YWxDb25maWciLCJtYWluQ29udGFpbmVyIiwiYiIsImMiLCJjaGFyc0JldHdlZW4iLCJrIiwiZ2V0VW51c2VkQnV0dG9uc0FycmF5IiwidG9vbGJhciIsImdldEN1cnNvciIsIkNvZGVNaXJyb3IiLCJQb3MiLCJsaW5lIiwiY2giLCJsZW5ndGgiLCJoIiwiZ2V0VG9rZW5BdCIsInN0YXJ0Iiwic3RyaW5nIiwiZiIsImZyb20iLCJ0byIsImxpc3QiLCJfaGFuZGxlcnMiLCJjdXIiLCJ0b2siLCJjaGFyQXQiLCJnZXRSYW5nZSIsInNwbGl0IiwicmV2ZXJzZSIsImpvaW4iLCJyZXBsYWNlIiwibWF0Y2giLCJlbmRDaGFyIiwic2V0VGltZW91dCIsInN0YXRlIiwiY29tcGxldGlvbkFjdGl2ZSIsInNob3dIaW50IiwiaGludHNDbGFzcyIsImNvbXBsZXRlU2luZ2xlIiwiUGFzcyIsIl9jcmVhdGVUb29sYmFyIiwidG9vbGJhckNvbnRhaW5lciIsImFwcGVuZCIsIl9zZXR1cEFjdHVhbENvbmZpZyIsIkNLRURJVE9SIiwidG9vbHMiLCJpc0FycmF5IiwibWFwIiwic3RyaW5naWZ5SlNPTmludG9PbmVMaW5lIiwiYWRkU3BhY2VzIiwibm9RdW90ZXNPbktleSIsInNpbmdsZVF1b3RlcyIsImRvbSIsImVsZW1lbnQiLCJhZGRDbGFzcyIsIm1vZGlmeUNvbnRhaW5lciIsIiQiLCJtb2RlIiwibmFtZSIsImpzb24iLCJsaW5lTnVtYmVycyIsImxpbmVXcmFwcGluZyIsInZpZXdwb3J0TWFyZ2luIiwiSW5maW5pdHkiLCJ2YWx1ZSIsInNtYXJ0SW5kZW50IiwiaW5kZW50V2l0aFRhYnMiLCJpbmRlbnRVbml0IiwidGFiU2l6ZSIsInRoZW1lIiwiZXh0cmFLZXlzIiwiTGVmdCIsIlJpZ2h0IiwiJycnIiwiJ1wiJyIsIkJhY2tzcGFjZSIsIkRlbGV0ZSIsIlNoaWZ0LVRhYiIsIm9uIiwicmVwbGFjZVNlbGVjdGlvbiIsImdldFZhbHVlIiwiX2V2YWx1YXRlVmFsdWUiLCJfZmlsbEhpbnRCeVVudXNlZEVsZW1lbnRzIiwiX3JlZnJlc2hFZGl0b3IiLCJyZW1vdmVDbGFzcyIsImluc2VydEJlZm9yZSIsImdyb3VwQnV0dG9uTmFtZXNCeUdyb3VwIiwiYnV0dG9ucyIsInJlZnJlc2giLCJzZXRIdG1sIiwiZ2V0VG9vbGJhckdyb3VwQnlCdXR0b25OYW1lIiwiZnVsbFRvb2xiYXJFZGl0b3IiLCJidXR0b25OYW1lc0J5R3JvdXAiLCJtYXBUb29sYmFyQ2ZnVG9FbGVtZW50c0xpc3QiLCJrZXlzIiwiZWRpdG9ySW5zdGFuY2UiLCJ1aSIsIml0ZW1zIiwiZmlsdGVyIiwidG9Mb3dlckNhc2UiLCJpbmRleE9mIiwic29ydCIsIkpTT04iLCJwYXJzZSIsInN0cmluZ2lmeSIsInB1c2giLCJjb25jYXQiLCJjb25maWciLCJ0b29sYmFyR3JvdXBzIiwiZ2V0RnVsbFRvb2xiYXJHcm91cHNDb25maWciLCJfZml4R3JvdXBzIiwiX21hcFRvb2xiYXJHcm91cHNUb1Rvb2xiYXIiLCJyZW1vdmVCdXR0b25zIiwicmVtb3ZlZEJ0bnMiLCJfbWFwVG9vbGJhclN1Ymdyb3VwIiwidHlwZSIsInNwbGljZSIsImdyb3VwcyIsImJ1dHRvbnNCeUdyb3VwIiwiX21hcEJ1dHRvbnNUb0J1dHRvbnNOYW1lcyIsInBvcCIsImdldENhbWVsQ2FzZWRCdXR0b25OYW1lIiwiRnVuY3Rpb24iLCJlZGl0b3JDb25maWciLCJtYXBUb29sYmFyVG9Ub29sYmFyR3JvdXBzIiwic2xpY2UiLCJtIiwicCIsIm4iLCJ1c2VkIiwib3JpZ2luIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUFZLFNBQVNBLEVBQUVDLEdBQUdDLEVBQUVDLEtBQUtDLEtBQUtILEdBQUdHLEtBQUtDLGNBQWNELEtBQUtFLGNBQWMsS0FBSyxJQUFJSixFQUFFSyxvQkFBb0JDLHdCQUF3QkMsRUFBRUYsb0JBQW9CRyxvQkFBa0JILG9CQUFvQkksb0JBQW9CWCxHQUFJWSxVQUFVQyxPQUFPQyxPQUFPWixFQUFFVSxZQUF1QkcsUUFBUSxTQUFTZCxFQUFFZSxHQUFHZCxFQUFFVSxVQUFVRyxRQUFRWixLQUFLQyxVQUFLLEVBQU9ZLEdBQUdaLEtBQUthLGdCQUFnQkQsRUFBRVosS0FBS2Msa0JBQWEsR0FBUSxtQkFBb0JqQixHQUFHQSxFQUFFRyxLQUFLZSxnQkFBZ0JuQixFQUFFWSxVQUFVSyxnQkFBZ0IsU0FBU2hCLEdBQUcsU0FBU2UsRUFBRWYsR0FBYyxHQUFHLFFBQVZtQixFQUFFQyxFQUFFcEIsSUFBZXFCLGFBQWEsQ0FBQyxJQUFJTixFQUN2Z0JPLEVBQUVDLHNCQUFzQkQsRUFBRUwsYUFBYU8sU0FBUSxFQUFHTCxFQUFFRSxjQUFjdEIsRUFBRUMsRUFBRXlCLFlBQVlOLEVBQUVPLFdBQVdDLElBQUk1QixFQUFFNkIsS0FBSzdCLEVBQUU4QixHQUFHVixFQUFFRSxhQUFhUyxRQUFRQyxFQUFFL0IsRUFBRWdDLFdBQVdqQyxHQUFxRSxHQUFsRSxNQUFNQyxFQUFFZ0MsV0FBVyxDQUFDSixLQUFLN0IsRUFBRTZCLEtBQUtDLEdBQUdFLEVBQUVFLFFBQVFDLFNBQVNuQixFQUFFLENBQUMsU0FBWSxJQUFJQSxFQUFFZSxPQUFPLE9BQU8sSUFBSUssRUFBRWhCLEVBQUVwQixFQUFFZ0IsSUFBSSxTQUFTb0IsRUFBRW5DLEVBQUVvQixFQUFFRCxHQUFHaEIsS0FBS2lDLEtBQUtwQyxFQUFFRyxLQUFLa0MsR0FBR2pCLEVBQUVqQixL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QVMsQ0FBQyxJQUFJbEgsRUFBRVIsRUFBRUQsR0FBR21ILE1BQU02QixFQUFFLEdBQUdBLEVBQUVwRSxLQUFLM0UsRUFBRUQsR0FBRzRFLEtBQUtvRSxFQUFFVCxPQUFPLEdBQUcsSUFBSSxJQUFJckksRUFBRU8sRUFBRXNCLE9BQU9rSCxFQUFFLEVBQUVBLEVBQUUvSSxFQUFFK0ksSUFBSSxDQUFDLElBQUlDLEVBQUV6SSxFQUFFd0ksR0FBRyxHQUFHLE1BQU1DLEVBQUUsQ0FBQyxJQUFJbEgsRUFBRTVCLEtBQUt3Ryw0QkFBNEJzQyxJQUFJLElBQUlGLEVBQUVULE9BQU9qQixRQUFRdEYsSUFBSWdILEVBQUVULE9BQU9aLEtBQUszRixHQUFHSSxFQUFFSixHQUFHSSxFQUFFSixJQUFJLElBQUdBLEVBQUVJLEVBQUVKLEdBQUd5RSxRQUFRckUsRUFBRUosR0FBR3lFLFNBQVMsSUFBS3lDLEdBQUdsSCxFQUFFa0gsSUFBSSxDQUFDQyxLQUFLLEVBQUVDLE9BQU9KLEVBQUVwRSxNQUFNNUMsRUFBRWtILEdBQUdDLFFBQVEvSCxFQUFFdUcsS0FBS3FCLEdBQ3JWLE1BQU0sQ0FBQ2xCLGNBQWMxRyxFQUFFOEcsZUFEaVU3RyxFQUFFLFNBQVNwQixFQUFFbUIsR0FBRyxJQUFTcEIsRUFBTHFCLEVBQUUsR0FBSyxJQUFJckIsS0FBS0MsRUFBRSxDQUFBLElBQUltQyxFQUFFbkMsRUFBRUQsR0FBR1MsRUFBRVcsRUFBRXBCLEdBQUcrSSxRQUMvZTFILEVBQUVBLEVBQUV1RyxPQUFPNUcsRUFBRVAsRUFBRUksT0FBT21HLEtBQUs1RSxFQUFFcUUsV0FBVyxPQUFPcEYsRUFEMFksQ0FDdlllLEVBQUVoQyxLQUFLeUcsa0JBQWtCQyxxQkFBMkQvRCxLQUFLLE9BYjNJIiwiZmlsZSI6ImNrZWRpdG9yL3NhbXBsZXMvdG9vbGJhcmNvbmZpZ3VyYXRvci9qcy90b29sYmFydGV4dG1vZGlmaWVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZShhKXtsLmNhbGwodGhpcyxhKTt0aGlzLmhpbnRDb250YWluZXI9dGhpcy5jb2RlQ29udGFpbmVyPW51bGx9dmFyIGw9VG9vbGJhckNvbmZpZ3VyYXRvci5BYnN0cmFjdFRvb2xiYXJNb2RpZmllcixnPVRvb2xiYXJDb25maWd1cmF0b3IuRnVsbFRvb2xiYXJFZGl0b3I7VG9vbGJhckNvbmZpZ3VyYXRvci5Ub29sYmFyVGV4dE1vZGlmaWVyPWU7ZS5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShsLnByb3RvdHlwZSk7ZS5wcm90b3R5cGUuX29uSW5pdD1mdW5jdGlvbihhLGQpe2wucHJvdG90eXBlLl9vbkluaXQuY2FsbCh0aGlzLHZvaWQgMCxkKTt0aGlzLl9jcmVhdGVNb2RpZmllcihkP3RoaXMuYWN0dWFsQ29uZmlnOnZvaWQgMCk7XCJmdW5jdGlvblwiPT09dHlwZW9mIGEmJmEodGhpcy5tYWluQ29udGFpbmVyKX07ZS5wcm90b3R5cGUuX2NyZWF0ZU1vZGlmaWVyPWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGQoYSl7dmFyIGI9YyhhKTtpZihudWxsIT09Yi5jaGFyc0JldHdlZW4pe3ZhciBkPVxyXG5rLmdldFVudXNlZEJ1dHRvbnNBcnJheShrLmFjdHVhbENvbmZpZy50b29sYmFyLCEwLGIuY2hhcnNCZXR3ZWVuKSxlPWEuZ2V0Q3Vyc29yKCksYj1Db2RlTWlycm9yLlBvcyhlLmxpbmUsZS5jaC1iLmNoYXJzQmV0d2Vlbi5sZW5ndGgpLGg9YS5nZXRUb2tlbkF0KGUpO1wie1wiPT09YS5nZXRUb2tlbkF0KHtsaW5lOmUubGluZSxjaDpoLnN0YXJ0fSkuc3RyaW5nJiYoZD1bXCJuYW1lXCJdKTtpZigwIT09ZC5sZW5ndGgpcmV0dXJuIG5ldyBmKGIsZSxkKX19ZnVuY3Rpb24gZihhLGMsYil7dGhpcy5mcm9tPWE7dGhpcy50bz1jO3RoaXMubGlzdD1iO3RoaXMuX2hhbmRsZXJzPVtdfWZ1bmN0aW9uIGMoYSxjKXt2YXIgYj17fTtiLmN1cj1hLmdldEN1cnNvcigpO2IudG9rPWEuZ2V0VG9rZW5BdChiLmN1cik7YltcImNoYXJcIl09Y3x8Yi50b2suc3RyaW5nLmNoYXJBdChiLnRvay5zdHJpbmcubGVuZ3RoLTEpO3ZhciBkPWEuZ2V0UmFuZ2UoQ29kZU1pcnJvci5Qb3MoYi5jdXIubGluZSwwKSxiLmN1cikuc3BsaXQoXCJcIikucmV2ZXJzZSgpLmpvaW4oXCJcIiksXHJcbmQ9ZC5yZXBsYWNlKC8oWyd8XCJdXFx3KlsnfFwiXSkvZyxcIlwiKTtiLmNoYXJzQmV0d2Vlbj1kLm1hdGNoKC8oXlxcdyopKFsnfFwiXSkvKTtiLmNoYXJzQmV0d2VlbiYmKGIuZW5kQ2hhcj1iLmNoYXJzQmV0d2VlblsyXSxiLmNoYXJzQmV0d2Vlbj1iLmNoYXJzQmV0d2VlblsxXS5zcGxpdChcIlwiKS5yZXZlcnNlKCkuam9pbihcIlwiKSk7cmV0dXJuIGJ9ZnVuY3Rpb24gYihhKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7YS5zdGF0ZS5jb21wbGV0aW9uQWN0aXZlfHxDb2RlTWlycm9yLnNob3dIaW50KGEsZCx7aGludHNDbGFzczpcInRvb2xiYXItbW9kaWZpZXJcIixjb21wbGV0ZVNpbmdsZTohMX0pfSwxMDApO3JldHVybiBDb2RlTWlycm9yLlBhc3N9dmFyIGs9dGhpczt0aGlzLl9jcmVhdGVUb29sYmFyKCk7dGhpcy50b29sYmFyQ29udGFpbmVyJiZ0aGlzLm1haW5Db250YWluZXIuYXBwZW5kKHRoaXMudG9vbGJhckNvbnRhaW5lcik7bC5wcm90b3R5cGUuX2NyZWF0ZU1vZGlmaWVyLmNhbGwodGhpcyk7XHJcbnRoaXMuX3NldHVwQWN0dWFsQ29uZmlnKGEpO2E9dGhpcy5hY3R1YWxDb25maWcudG9vbGJhcjthPUNLRURJVE9SLnRvb2xzLmlzQXJyYXkoYSk/XCJcXHRjb25maWcudG9vbGJhciBcXHgzZCBcIisoXCJbXFxuXFx0XFx0XCIrZy5tYXAoYSxmdW5jdGlvbihhKXtyZXR1cm4gbC5zdHJpbmdpZnlKU09OaW50b09uZUxpbmUoYSx7YWRkU3BhY2VzOiEwLG5vUXVvdGVzT25LZXk6ITAsc2luZ2xlUXVvdGVzOiEwfSl9KS5qb2luKFwiLFxcblxcdFxcdFwiKStcIlxcblxcdF1cIikrXCI7XCI6XCJjb25maWcudG9vbGJhciBcXHgzZCBbXTtcIjthPVtcIkNLRURJVE9SLmVkaXRvckNvbmZpZyBcXHgzZCBmdW5jdGlvbiggY29uZmlnICkge1xcblwiLGEsXCJcXG59O1wiXS5qb2luKFwiXCIpO3ZhciBlPW5ldyBDS0VESVRPUi5kb20uZWxlbWVudChcImRpdlwiKTtlLmFkZENsYXNzKFwiY29kZW1pcnJvci13cmFwcGVyXCIpO3RoaXMubW9kaWZ5Q29udGFpbmVyLmFwcGVuZChlKTt0aGlzLmNvZGVDb250YWluZXI9Q29kZU1pcnJvcihlLiQse21vZGU6e25hbWU6XCJqYXZhc2NyaXB0XCIsXHJcbmpzb246ITB9LGxpbmVOdW1iZXJzOiExLGxpbmVXcmFwcGluZzohMCx2aWV3cG9ydE1hcmdpbjpJbmZpbml0eSx2YWx1ZTphLHNtYXJ0SW5kZW50OiExLGluZGVudFdpdGhUYWJzOiEwLGluZGVudFVuaXQ6NCx0YWJTaXplOjQsdGhlbWU6XCJuZW9cIixleHRyYUtleXM6e0xlZnQ6YixSaWdodDpiLFwiJycnXCI6YixcIidcXFwiJ1wiOmIsQmFja3NwYWNlOmIsRGVsZXRlOmIsXCJTaGlmdC1UYWJcIjpcImluZGVudExlc3NcIn19KTt0aGlzLmNvZGVDb250YWluZXIub24oXCJlbmRDb21wbGV0aW9uXCIsZnVuY3Rpb24oYSxiKXt2YXIgZD1jKGEpO3ZvaWQgMCE9PWImJmEucmVwbGFjZVNlbGVjdGlvbihkLmVuZENoYXIpfSk7dGhpcy5jb2RlQ29udGFpbmVyLm9uKFwiY2hhbmdlXCIsZnVuY3Rpb24oKXt2YXIgYT1rLmNvZGVDb250YWluZXIuZ2V0VmFsdWUoKSxhPWsuX2V2YWx1YXRlVmFsdWUoYSk7bnVsbCE9PWE/KGsuYWN0dWFsQ29uZmlnLnRvb2xiYXI9YS50b29sYmFyP2EudG9vbGJhcjprLmFjdHVhbENvbmZpZy50b29sYmFyLFxyXG5rLl9maWxsSGludEJ5VW51c2VkRWxlbWVudHMoKSxrLl9yZWZyZXNoRWRpdG9yKCksay5tYWluQ29udGFpbmVyLnJlbW92ZUNsYXNzKFwiaW52YWxpZFwiKSk6ay5tYWluQ29udGFpbmVyLmFkZENsYXNzKFwiaW52YWxpZFwiKX0pO3RoaXMuaGludENvbnRhaW5lcj1uZXcgQ0tFRElUT1IuZG9tLmVsZW1lbnQoXCJkaXZcIik7dGhpcy5oaW50Q29udGFpbmVyLmFkZENsYXNzKFwidG9vbGJhck1vZGlmaWVyLWhpbnRzXCIpO3RoaXMuX2ZpbGxIaW50QnlVbnVzZWRFbGVtZW50cygpO3RoaXMuaGludENvbnRhaW5lci5pbnNlcnRCZWZvcmUoZSl9O2UucHJvdG90eXBlLl9maWxsSGludEJ5VW51c2VkRWxlbWVudHM9ZnVuY3Rpb24oKXt2YXIgYT10aGlzLmdldFVudXNlZEJ1dHRvbnNBcnJheSh0aGlzLmFjdHVhbENvbmZpZy50b29sYmFyLCEwKSxhPXRoaXMuZ3JvdXBCdXR0b25OYW1lc0J5R3JvdXAoYSksZD1nLm1hcChhLGZ1bmN0aW9uKGEpe3ZhciBiPWcubWFwKGEuYnV0dG9ucyxmdW5jdGlvbihhKXtyZXR1cm5cIlxceDNjY29kZVxceDNlXCIrXHJcbmErXCJcXHgzYy9jb2RlXFx4M2UgXCJ9KS5qb2luKFwiXCIpO3JldHVybltcIlxceDNjZHRcXHgzZVxceDNjY29kZVxceDNlXCIsYS5uYW1lLFwiXFx4M2MvY29kZVxceDNlXFx4M2MvZHRcXHgzZVxceDNjZGRcXHgzZVwiLGIsXCJcXHgzYy9kZFxceDNlXCJdLmpvaW4oXCJcIil9KS5qb2luKFwiIFwiKSxmPSdcXHgzY2R0IGNsYXNzXFx4M2RcImxpc3QtaGVhZGVyXCJcXHgzZVRvb2xiYXIgZ3JvdXBcXHgzYy9kdFxceDNlXFx4M2NkZCBjbGFzc1xceDNkXCJsaXN0LWhlYWRlclwiXFx4M2VVbnVzZWQgaXRlbXNcXHgzYy9kZFxceDNlJzthLmxlbmd0aHx8KGY9XCJcXHgzY3BcXHgzZUFsbCBpdGVtcyBhcmUgaW4gdXNlLlxceDNjL3BcXHgzZVwiKTt0aGlzLmNvZGVDb250YWluZXIucmVmcmVzaCgpO3RoaXMuaGludENvbnRhaW5lci5zZXRIdG1sKFwiXFx4M2NoM1xceDNlVW51c2VkIHRvb2xiYXIgaXRlbXNcXHgzYy9oM1xceDNlXFx4M2NkbFxceDNlXCIrZitkK1wiXFx4M2MvZGxcXHgzZVwiKX07ZS5wcm90b3R5cGUuZ2V0VG9vbGJhckdyb3VwQnlCdXR0b25OYW1lPWZ1bmN0aW9uKGEpe3ZhciBkPVxyXG50aGlzLmZ1bGxUb29sYmFyRWRpdG9yLmJ1dHRvbk5hbWVzQnlHcm91cCxmO2ZvcihmIGluIGQpZm9yKHZhciBjPWRbZl0sYj1jLmxlbmd0aDtiLS07KWlmKGE9PT1jW2JdKXJldHVybiBmO3JldHVybiBudWxsfTtlLnByb3RvdHlwZS5nZXRVbnVzZWRCdXR0b25zQXJyYXk9ZnVuY3Rpb24oYSxkLGYpe2Q9ITA9PT1kPyEwOiExO3ZhciBjPWUubWFwVG9vbGJhckNmZ1RvRWxlbWVudHNMaXN0KGEpO2E9T2JqZWN0LmtleXModGhpcy5mdWxsVG9vbGJhckVkaXRvci5lZGl0b3JJbnN0YW5jZS51aS5pdGVtcyk7YT1nLmZpbHRlcihhLGZ1bmN0aW9uKGEpe3ZhciBkPVwiLVwiPT09YTthPXZvaWQgMD09PWZ8fDA9PT1hLnRvTG93ZXJDYXNlKCkuaW5kZXhPZihmLnRvTG93ZXJDYXNlKCkpO3JldHVybiFkJiZhfSk7YT1nLmZpbHRlcihhLGZ1bmN0aW9uKGEpe3JldHVybi0xPT1DS0VESVRPUi50b29scy5pbmRleE9mKGMsYSl9KTtkJiZhLnNvcnQoKTtyZXR1cm4gYX07ZS5wcm90b3R5cGUuZ3JvdXBCdXR0b25OYW1lc0J5R3JvdXA9XHJcbmZ1bmN0aW9uKGEpe3ZhciBkPVtdLGY9SlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmZ1bGxUb29sYmFyRWRpdG9yLmJ1dHRvbk5hbWVzQnlHcm91cCkpLGM7Zm9yKGMgaW4gZil7dmFyIGI9ZltjXSxiPWcuZmlsdGVyKGIsZnVuY3Rpb24oYil7cmV0dXJuLTEhPT1DS0VESVRPUi50b29scy5pbmRleE9mKGEsYil9KTtiLmxlbmd0aCYmZC5wdXNoKHtuYW1lOmMsYnV0dG9uczpifSl9cmV0dXJuIGR9O2UubWFwVG9vbGJhckNmZ1RvRWxlbWVudHNMaXN0PWZ1bmN0aW9uKGEpe2Z1bmN0aW9uIGQoYSl7cmV0dXJuXCItXCIhPT1hfWZvcih2YXIgZj1bXSxjPWEubGVuZ3RoLGI9MDtiPGM7Yis9MSlhW2JdJiZcInN0cmluZ1wiIT09dHlwZW9mIGFbYl0mJihmPWYuY29uY2F0KGcuZmlsdGVyKGFbYl0uaXRlbXMsZCkpKTtyZXR1cm4gZn07ZS5wcm90b3R5cGUuX3NldHVwQWN0dWFsQ29uZmlnPWZ1bmN0aW9uKGEpe2E9YXx8dGhpcy5lZGl0b3JJbnN0YW5jZS5jb25maWc7Q0tFRElUT1IudG9vbHMuaXNBcnJheShhLnRvb2xiYXIpfHxcclxuKGEudG9vbGJhckdyb3Vwc3x8KGEudG9vbGJhckdyb3Vwcz10aGlzLmZ1bGxUb29sYmFyRWRpdG9yLmdldEZ1bGxUb29sYmFyR3JvdXBzQ29uZmlnKCEwKSksdGhpcy5fZml4R3JvdXBzKGEpLGEudG9vbGJhcj10aGlzLl9tYXBUb29sYmFyR3JvdXBzVG9Ub29sYmFyKGEudG9vbGJhckdyb3Vwcyx0aGlzLmFjdHVhbENvbmZpZy5yZW1vdmVCdXR0b25zKSx0aGlzLmFjdHVhbENvbmZpZy50b29sYmFyPWEudG9vbGJhcix0aGlzLmFjdHVhbENvbmZpZy5yZW1vdmVCdXR0b25zPVwiXCIpfTtlLnByb3RvdHlwZS5fbWFwVG9vbGJhckdyb3Vwc1RvVG9vbGJhcj1mdW5jdGlvbihhLGQpe2Q9ZHx8dGhpcy5lZGl0b3JJbnN0YW5jZS5jb25maWcucmVtb3ZlZEJ0bnM7ZD1cInN0cmluZ1wiPT10eXBlb2YgZD9kLnNwbGl0KFwiLFwiKTpbXTtmb3IodmFyIGY9YS5sZW5ndGg7Zi0tOyl7dmFyIGM9dGhpcy5fbWFwVG9vbGJhclN1Ymdyb3VwKGFbZl0sZCk7XCJzZXBhcmF0b3JcIj09PWFbZl0udHlwZT9hW2ZdPVwiL1wiOlxyXG5DS0VESVRPUi50b29scy5pc0FycmF5KGMpJiYwPT09Yy5sZW5ndGg/YS5zcGxpY2UoZiwxKTphW2ZdPVwic3RyaW5nXCI9PXR5cGVvZiBjP2M6e25hbWU6YVtmXS5uYW1lLGl0ZW1zOmN9fXJldHVybiBhfTtlLnByb3RvdHlwZS5fbWFwVG9vbGJhclN1Ymdyb3VwPWZ1bmN0aW9uKGEsZCl7aWYoXCJzdHJpbmdcIj09dHlwZW9mIGEpcmV0dXJuIGE7Zm9yKHZhciBmPWEuZ3JvdXBzP2EuZ3JvdXBzLmxlbmd0aDowLGM9W10sYj0wO2I8ZjtiKz0xKXt2YXIgZT1hLmdyb3Vwc1tiXSxlPXRoaXMuZnVsbFRvb2xiYXJFZGl0b3IuYnV0dG9uc0J5R3JvdXBbXCJzdHJpbmdcIj09PXR5cGVvZiBlP2U6ZS5uYW1lXXx8W10sZT10aGlzLl9tYXBCdXR0b25zVG9CdXR0b25zTmFtZXMoZSxkKSxnPWUubGVuZ3RoLGM9Yy5jb25jYXQoZSk7ZyYmYy5wdXNoKFwiLVwiKX1cIi1cIj09Y1tjLmxlbmd0aC0xXSYmYy5wb3AoKTtyZXR1cm4gY307ZS5wcm90b3R5cGUuX21hcEJ1dHRvbnNUb0J1dHRvbnNOYW1lcz1mdW5jdGlvbihhLFxyXG5kKXtmb3IodmFyIGY9YS5sZW5ndGg7Zi0tOyl7dmFyIGM9YVtmXSxjPVwic3RyaW5nXCI9PT10eXBlb2YgYz9jOnRoaXMuZnVsbFRvb2xiYXJFZGl0b3IuZ2V0Q2FtZWxDYXNlZEJ1dHRvbk5hbWUoYy5uYW1lKTstMSE9PUNLRURJVE9SLnRvb2xzLmluZGV4T2YoZCxjKT9hLnNwbGljZShmLDEpOmFbZl09Y31yZXR1cm4gYX07ZS5wcm90b3R5cGUuX2V2YWx1YXRlVmFsdWU9ZnVuY3Rpb24oYSl7dmFyIGQ7dHJ5e3ZhciBmPXt9O0Z1bmN0aW9uKFwidmFyIENLRURJVE9SIFxceDNkIHt9OyBcIithK1wiOyByZXR1cm4gQ0tFRElUT1I7XCIpKCkuZWRpdG9yQ29uZmlnKGYpO2Q9Zjtmb3IodmFyIGM9ZC50b29sYmFyLmxlbmd0aDtjLS07KWQudG9vbGJhcltjXXx8ZC50b29sYmFyLnNwbGljZShjLDEpfWNhdGNoKGIpe2Q9bnVsbH1yZXR1cm4gZH07ZS5wcm90b3R5cGUubWFwVG9vbGJhclRvVG9vbGJhckdyb3Vwcz1mdW5jdGlvbihhKXtmdW5jdGlvbiBkKGEsYil7YT1hLnNsaWNlKCk7Zm9yKHZhciBkPVxyXG5iLmxlbmd0aDtkLS07KXt2YXIgYz1hLmluZGV4T2YoYltkXSk7LTEhPT1jJiZhLnNwbGljZShjLDEpfXJldHVybiBhfWZvcih2YXIgZj17fSxjPVtdLGI9W10sYz1hLmxlbmd0aCxlPTA7ZTxjO2UrKylpZihcIi9cIj09PWFbZV0pYi5wdXNoKFwiL1wiKTtlbHNle3ZhciBnPWFbZV0uaXRlbXMsbT17fTttLm5hbWU9YVtlXS5uYW1lO20uZ3JvdXBzPVtdO2Zvcih2YXIgbD1nLmxlbmd0aCxwPTA7cDxsO3ArKyl7dmFyIG49Z1twXTtpZihcIi1cIiE9PW4pe3ZhciBoPXRoaXMuZ2V0VG9vbGJhckdyb3VwQnlCdXR0b25OYW1lKG4pOy0xPT09bS5ncm91cHMuaW5kZXhPZihoKSYmbS5ncm91cHMucHVzaChoKTtmW2hdPWZbaF18fHt9O2g9ZltoXS5idXR0b25zPWZbaF0uYnV0dG9uc3x8e307aFtuXT1oW25dfHx7dXNlZDowLG9yaWdpbjptLm5hbWV9O2hbbl0udXNlZCsrfX1iLnB1c2gobSl9Yz1mdW5jdGlvbihhLGIpe3ZhciBjPVtdLGU7Zm9yKGUgaW4gYSl2YXIgZj1hW2VdLGc9YltlXS5zbGljZSgpLFxyXG5jPWMuY29uY2F0KGQoZyxPYmplY3Qua2V5cyhmLmJ1dHRvbnMpKSk7cmV0dXJuIGN9KGYsdGhpcy5mdWxsVG9vbGJhckVkaXRvci5idXR0b25OYW1lc0J5R3JvdXApO3JldHVybnt0b29sYmFyR3JvdXBzOmIscmVtb3ZlQnV0dG9uczpjLmpvaW4oXCIsXCIpfX07cmV0dXJuIGV9KSgpOyJdfQ==
